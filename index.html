<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Regardez la Vidéo — Aqisio</title>

  <!-- Perf hints -->
  <link rel="preconnect" href="https://videodelivery.net" crossorigin>
  <link rel="preconnect" href="https://unpkg.com" crossorigin>

  <!-- Video.js -->
  <link href="https://unpkg.com/video.js@8/dist/video-js.css" rel="stylesheet">
  <script defer src="https://unpkg.com/video.js@8/dist/video.min.js"></script>
  <!-- hls.js: uniquement si le navigateur ne lit pas HLS nativement -->
  <script defer src="https://unpkg.com/hls.js@1.5.13/dist/hls.min.js"></script>

  <style>
    :root { color-scheme: dark; }
    body{ margin:0; background:#0b0b0b; color:#fff; font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif; }
    .wrap{ display:grid; place-items:center; min-height:100dvh; padding:16px; }
    .video-js{ width:min(1200px,100%); aspect-ratio:16/9; background:#000; border-radius:12px; overflow:hidden; }

    /* Sous-titres natifs en BLEU (style Loom-like simple) */
    /* Cible le <video> natif sous Video.js */
    .video-js video::cue {
      color:#fff;
      background:#1a73e8;
      font-weight:600;
      line-height:1.35;
      padding:0.15em 0.4em;
      border-radius:0.6em;
      text-shadow:none;
    }
    /* Fallback au cas où (selon moteurs) */
    video::cue {
      color:#fff;
      background:#1a73e8;
      font-weight:600;
      line-height:1.35;
      padding:0.15em 0.4em;
      border-radius:0.6em;
      text-shadow:none;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <video
      id="aqisioPlayer"
      class="video-js vjs-default-skin"
      controls
      playsinline
      preload="metadata"
    >
      <!-- 1) REMPLACE ICI par ton vrai manifest HLS -->
      <source
        src="https://videodelivery.net/TON_VIDEO_ID/manifest/video.m3u8"
        type="application/x-mpegURL"
      />

      <!-- 2) REMPLACE ICI par l’URL HTTPS publique de ton fichier .vtt -->
      <track
        kind="subtitles"
        srclang="fr"
        label="Français"
        src="https://ton-bucket.r2.dev/chemin/sous-titres.vtt"
        default
      >
    </video>
  </div>

  <script>
    // Init Video.js
    const player = videojs('aqisioPlayer', { controls:true, preload:'metadata' });

    // Activer les sous-titres natifs (affichage intégré du navigateur)
    player.on('loadedmetadata', () => {
      const videoEl = player.tech().el();
      for (const tt of videoEl.textTracks) {
        if (tt.kind === 'subtitles') { tt.mode = 'showing'; }
      }
    });

    // Fallback HLS.js si le navigateur ne gère pas HLS nativement
    player.ready(() => {
      const src = player.currentSource()?.src;
      const tech = player.tech(true);
      const needHls = src && src.endsWith('.m3u8') && tech && !tech.featuresNativeHls;
      if (needHls && window.Hls && window.Hls.isSupported()) {
        const video = tech.el();
        const hls = new Hls();
        hls.loadSource(src);
        hls.attachMedia(video);
      }
    });
  </script>
</body>
</html>
